<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Pixabay‑like · Phone upload gallery</title>
    <!-- Font Awesome 6 (free) for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* === GLOBAL RESET & FONTS === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background: #f5f7fb;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #1e293b;
        }

        /* === HEADER / UPLOAD BAR (sticky) === */
        .header {
            background: white;
            padding: 1rem 1.5rem;
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.03), 0 2px 6px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .logo-area {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-weight: 600;
            font-size: 1.5rem;
            color: #0f172a;
        }

        .logo-area i {
            color: #3b82f6;
            font-size: 2rem;
        }

        .upload-container {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 0.8rem;
            background: #f8fafc;
            padding: 0.5rem 1rem;
            border-radius: 60px;
            border: 1px solid #e2e8f0;
            flex: 1 1 auto;
            max-width: 600px;
            backdrop-filter: blur(2px);
        }

        .custom-file-label {
            background: #ffffff;
            border: 1px solid #cbd5e1;
            border-radius: 40px;
            padding: 0.6rem 1.4rem;
            font-size: 0.95rem;
            font-weight: 500;
            color: #334155;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: 0.2s;
            white-space: nowrap;
        }

        .custom-file-label i {
            color: #3b82f6;
        }

        .custom-file-label:hover {
            background: #eef2ff;
            border-color: #3b82f6;
        }

        #file-input {
            position: absolute;
            opacity: 0;
            width: 0.1px;
            height: 0.1px;
        }

        .upload-btn {
            background: #3b82f6;
            border: none;
            color: white;
            padding: 0.6rem 1.8rem;
            border-radius: 40px;
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: 0.15s;
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.25);
            border: 1px solid #2563eb;
            white-space: nowrap;
        }

        .upload-btn:active {
            transform: scale(0.97);
            background: #2563eb;
        }

        .upload-btn i {
            font-size: 1rem;
        }

        .status-message {
            font-size: 0.9rem;
            color: #475569;
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 6px;
            background: white;
            padding: 0.3rem 1rem;
            border-radius: 40px;
            border: 1px solid #e2e8f0;
        }

        /* === GALLERY GRID (masonry style) === */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1.5rem;
            padding: 2rem 1.5rem;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }

        .gallery-card {
            background: white;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.04), 0 4px 8px rgba(0, 0, 0, 0.02);
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            border: 1px solid #f1f5f9;
            position: relative;
            animation: fadeIn 0.3s;
        }

        .gallery-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 24px 40px rgba(0, 0, 0, 0.08);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        .image-wrapper {
            width: 100%;
            aspect-ratio: 1 / 1;  /* square crop, like Pixabay thumb */
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            cursor: pointer;
            border-bottom: 1px solid #eef2f6;
        }

        .image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
            display: block;
        }

        .gallery-card:hover img {
            transform: scale(1.03);
        }

        .card-footer {
            padding: 0.9rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
        }

        .filename {
            font-size: 0.8rem;
            font-weight: 500;
            color: #334155;
            max-width: 140px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .delete-btn {
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 1.1rem;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: 50px;
            transition: 0.15s;
        }

        .delete-btn:hover {
            background: #fee2e2;
            color: #ef4444;
        }

        .empty-gallery {
            grid-column: 1 / -1;
            text-align: center;
            padding: 4rem 2rem;
            color: #64748b;
            background: white;
            border-radius: 48px;
            margin: 2rem;
            border: 2px dashed #cbd5e1;
            font-size: 1.2rem;
        }

        .empty-gallery i {
            font-size: 4rem;
            color: #94a3b8;
            margin-bottom: 1rem;
            opacity: 0.7;
        }

        /* image preview modal (lightbox) */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(4px);
            align-items: center;
            justify-content: center;
            z-index: 1000;
            cursor: pointer;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            max-width: 90vw;
            max-height: 85vh;
            border-radius: 24px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.5);
            border: 3px solid white;
            background: white;
            object-fit: contain;
        }

        .modal-close {
            position: absolute;
            top: 20px; right: 30px;
            color: white;
            font-size: 3rem;
            cursor: pointer;
            font-weight: 300;
            text-shadow: 0 4px 8px black;
        }

        /* responsive touches */
        @media (max-width: 600px) {
            .header {
                flex-direction: column;
                align-items: stretch;
            }
            .upload-container {
                max-width: 100%;
            }
            .status-message {
                margin-left: 0;
                justify-content: center;
            }
        }
    </style>
</head>
<body>

    <!-- STICKY HEADER with upload area -->
    <header class="header">
        <div class="logo-area">
            <i class="fas fa-cloud-upload-alt"></i>
            <span>PixelStore</span>
        </div>

        <div class="upload-container">
            <!-- hidden file input (accept images) -->
            <input type="file" id="file-input" accept="image/*" multiple>

            <label for="file-input" class="custom-file-label">
                <i class="fas fa-images"></i> Choose images
            </label>

            <button class="upload-btn" id="uploadBtn">
                <i class="fas fa-arrow-up"></i> Upload
            </button>

            <span class="status-message" id="statusMsg">
                <i class="fas fa-mobile-alt"></i> <span id="counter">0</span> images
            </span>
        </div>
    </header>

    <!-- GALLERY GRID - images will appear here -->
    <main>
        <div class="gallery" id="galleryGrid">
            <!-- empty placeholder will be shown by JS if no images -->
        </div>
    </main>

    <!-- LIGHTBOX MODAL -->
    <div class="modal" id="imageModal" onclick="closeModal()">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="modalImg" alt="preview">
    </div>

    <!-- JavaScript (pure, no frameworks) -->
    <script>
        (function() {
            // ==================== STATE ====================
            // in‑memory array of uploaded images (stores dataURL and name)
            let images = [];

            // DOM elements
            const fileInput = document.getElementById('file-input');
            const uploadBtn = document.getElementById('uploadBtn');
            const galleryGrid = document.getElementById('galleryGrid');
            const counterSpan = document.getElementById('counter');
            const statusMsgDiv = document.getElementById('statusMsg');
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImg');

            // ==================== HELPERS ====================
            function updateCounter() {
                counterSpan.textContent = images.length;
                // optional: change status colour if empty
                if (images.length === 0) {
                    statusMsgDiv.style.background = '#f1f5f9';
                } else {
                    statusMsgDiv.style.background = 'white';
                }
            }

            // close modal (global for onclick)
            window.closeModal = function() {
                modal.classList.remove('active');
            };

            // open image in modal
            function openModal(src) {
                modalImg.src = src;
                modal.classList.add('active');
            }

            // delete image from array and re-render gallery
            function deleteImage(index) {
                if (index >= 0 && index < images.length) {
                    images.splice(index, 1);
                    renderGallery();
                }
            }

            // ==================== RENDER GALLERY ====================
            function renderGallery() {
                if (images.length === 0) {
                    galleryGrid.innerHTML = `
                        <div class="empty-gallery">
                            <i class="fas fa-cloud-upload-alt"></i><br>
                            No images yet.<br>Upload from your phone using the button above.
                        </div>
                    `;
                    updateCounter();
                    return;
                }

                let htmlString = '';
                images.forEach((img, idx) => {
                    // generate short name (max 15 chars)
                    let shortName = img.name.length > 18 ? img.name.substring(0, 15) + '…' : img.name;
                    htmlString += `
                        <div class="gallery-card" data-index="${idx}">
                            <div class="image-wrapper" onclick="(function(e){
                                e.stopPropagation();
                                openModal('${img.dataURL}')
                            })(event)">
                                <img src="${img.dataURL}" alt="${img.name}" loading="lazy">
                            </div>
                            <div class="card-footer">
                                <span class="filename" title="${img.name}">${shortName}</span>
                                <button class="delete-btn" onclick="(function(e){
                                    e.stopPropagation();
                                    deleteImage(${idx});
                                })(event)" aria-label="Delete image"><i class="fas fa-trash-alt"></i></button>
                            </div>
                        </div>
                    `;
                });

                galleryGrid.innerHTML = htmlString;
                updateCounter();
            }

            // ==================== UPLOAD HANDLER ====================
            function processFiles(files) {
                if (!files || files.length === 0) return;

                let pending = files.length;
                let processed = 0;

                // iterate through FileList
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];

                    // validate if it's an image (optional but recommended)
                    if (!file.type.startsWith('image/')) {
                        pending--;
                        continue;  // skip non-image files silently (or you could warn)
                    }

                    const reader = new FileReader();

                    reader.onload = (function(f) {
                        return function(e) {
                            // store image object
                            images.push({
                                dataURL: e.target.result,
                                name: f.name || 'image.jpg',
                                type: f.type,
                                lastModified: f.lastModified
                            });

                            processed++;
                            if (processed === pending) {
                                // all current batch done -> re-render
                                renderGallery();
                                // reset file input so same file can be uploaded again
                                fileInput.value = '';
                            }
                        };
                    })(file);

                    reader.onerror = function() {
                        processed++;
                        if (processed === pending) {
                            renderGallery();
                            fileInput.value = '';
                        }
                    };

                    reader.readAsDataURL(file);
                }

                // edge case: if no valid images, still reset input
                if (pending === 0) {
                    fileInput.value = '';
                }
            }

            // ==================== EVENT LISTENERS ====================

            // 1) Upload button: read whatever is in fileInput
            uploadBtn.addEventListener('click', function() {
                if (fileInput.files.length > 0) {
                    processFiles(fileInput.files);
                } else {
                    // subtle feedback: quick flash
                    statusMsgDiv.style.backgroundColor = '#fff3cd';
                    statusMsgDiv.innerHTML = `<i class="fas fa-exclamation-circle"></i> no files selected`;
                    setTimeout(() => {
                        statusMsgDiv.innerHTML = `<i class="fas fa-mobile-alt"></i> <span id="counter">${images.length}</span> images`;
                        statusMsgDiv.style.background = '';
                    }, 1200);
                }
            });

            // 2) Optional: handle drag & drop? but spec says "upload directly from phone" – we already have file input.
            //    But mobile users usually tap "Choose images" then select. Also allow "change" on input directly.
            fileInput.addEventListener('change', function() {
                // if user selects via file dialog, we wait for upload button click (conventional)
                // However many users expect auto-upload after selection. We'll implement both:
                // you can either press Upload, or we auto-upload on change (feels nicer)
                if (fileInput.files.length > 0) {
                    processFiles(fileInput.files);
                }
            });

            // 3) Expose delete and modal functions globally so inline onclick works
            window.openModal = openModal;
            window.deleteImage = deleteImage;

            // 4) Click outside modal to close (already via modal bg)
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeModal();
            });

            // 5) initial render (empty gallery)
            renderGallery();

            // 6) (optional) prevent accidental modal close from inner image click
            modalImg.addEventListener('click', function(e) {
                e.stopPropagation();
            });

            // 7) extra: handle escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.classList.contains('active')) {
                    closeModal();
                }
            });

        })();

    </script>

    <!-- small footnote: images stored only in memory (session). Refresh will reset. In real app you'd use localStorage/IndexedDB. -->
    <div style="text-align: center; font-size: 0.8rem; color: #94a3b8; padding: 1rem 0 2rem;">
        <i class="fas fa-database"></i> images are temporarily stored in memory — refresh will clear them.
    </div>
</body>
</html>
